!function(){"use strict";"function"==typeof define&&define.amd||(window.define=function(){arguments[arguments.length-1]()})}(),define("helpers",[],function(){"use strict";var a=window.Coccyx=window.Coccyx||{};a.helpers={isSilent:function(a){return a.length&&!Array.isArray(a[a.length-1])&&"object"==typeof a[a.length-1]&&a[a.length-1].silent},contains:function(a,b){if("string"==typeof a)for(var c=0,d=a.length;d>c;c++)if(a[c]===b)return!0;return!1},deepCopy:function(a){return JSON.parse(JSON.stringify(a))},extend:function(a){for(var b,c=1,d=arguments.length-1;d>=c;c++)for(b in arguments[c])arguments[c].hasOwnProperty(b)&&(a[b]=arguments[c][b]);return a},replace:function(a,b){for(var c in a)a.hasOwnProperty(c)&&b.hasOwnProperty(c)&&(a[c]=b[c]);return a},uniqueNamepspace:function(){var a=1;return function(){return a++}}()}}),define("application",["jquery"],function(){"use strict";function a(){1===arguments.length||arguments[0]instanceof Array||arguments[0]instanceof Object||console.log("registerControllers missing or invalid param. Expected an [] or {}."),arguments[0]instanceof Array?arguments[0].forEach(function(a){b(a)}):b(arguments[0])}function b(a){var b;console.log("Registering controller '"+a.name+"'"),a.$=e.$,f[a.name]=a;for(var c in a.routes)a.routes.hasOwnProperty(c)&&(b=c.substring(0,c.indexOf(" ")+1)+"/",b+=a.name,b+="/"===c.substring(c.indexOf(" ")+1)?"":""===a.name?c.substring(c.indexOf(" ")+1):"/"+c.substring(c.indexOf(" ")+1),g[b]=[a.name,a.routes[c]],console.log("Registering route '"+b+"'"))}function c(){return g}function d(a){return f[a]}var e=window.Coccyx=window.Coccyx||{},f={},g={},h="0.6.4";e.$=jQuery,e.application=e.application||{},e.init=function(){},e.plugins=e.plugins||{},e.getVersion=function(){return h},e.controllers={registerControllers:a,getRoutes:c,getController:d}}),define("ajax",["helpers","application"],function(){"use strict";function a(a,b){return a.type=b,d({},c,a)}var b=window.Coccyx=window.Coccyx||{},c={dataType:"json",cache:!1,url:"/"},d=b.helpers.extend,e=b.$.ajax;b.ajax={ajaxGet:function(b){return e(a(b,"GET"))},ajaxPost:function(b){return e(a(b,"POST"))},ajaxPut:function(b){return e(a(b,"PUT"))},ajaxDelete:function(b){return e(a(b,"DELETE"))}}}),define("eventer",["helpers","application"],function(){"use strict";function a(a){return a&&a._eventedObj&&a._eventedObj.namespace&&a._eventedObj.listeners}function b(a){return a._eventedObj.listeners}function c(a,b){return a._eventedObj.hasOwnProperty(b)?a._eventedObj[b]:void 0}function d(a){return a._eventedObj.namespace}function e(){return Object.create(l)}function f(a){return p(Object.create(m),{listeningToNamespace:d(a),listeningToObj:a,events:[]})}function g(a,b,c,e){var g=a._eventedObj.listeners[d(b)]=a._eventedObj.listeners[d(b)]||f(b);g.addEvent(event,e)}function h(a,e,f,g){var h=c(a,d(e));return function(){h.removeEvent(f,g),b(a).removeProperty(d(e)),g.apply(a,[].slice.call(arguments))}}function i(a,c){var e;if(c.listeningToObj||c.event||c.callback)!c.listeningToObj&&c.event&&c.callback||(c.listeningToObj||!c.event||optios.callback)&&(c.listeningToObj||c.event||!c.callback)&&(!c.listeningToObj||c.event||c.callback?c.listeningToObj&&c.event&&c.callback?c.event.split(" ").forEach(function(e){n.$(c.listeningToObj).off(e+"."+d(a),c.callback),b(a)[d(c.listeningToObj)].removeEvent({event:c.event,callback:c.callback}),b(a).removeProperty(d(c.listeningToObj))}):c.listeningToObj&&c.event&&!c.callback?c.event.split(" ").forEach(function(e){n.$(c.listeningToObj).off(e+"."+d(a)),b(a)[d(c.listeningToObj)].removeEvent({event:c.event}),b(a).removeProperty(c.listeningToObj)}):c.listeningToObj&&!c.event&&c.callback&&(n.$(c.listeningToObj).off("."+d(a),c.callback),b(a)[d(c.listeningToObj)].removeEvent({callback:c.callback}),b(a).removeProperty(c.listeningToObj)):(n.$(c.listeningToObj).off("."+d(a)),b(a).removeProperty(d(c.listeningToObj))));else{for(e in b(a))b(a).hasOwnProperty(e)&&n.$(b(a)[e].listeningToObj).off("."+d(a));b(a).removeAllProperties()}}function j(a){var b=a._eventedObj?a:n.helpers.extend(a,k);return b._eventedObj=a._eventedObj?a._eventedObj:{},b._eventedObj.namespace="eventer_"+o(),b._eventedObj.listeners=e(),b}var k,l,m,n=window.Coccyx=window.Coccyx||{},o=n.helpers.uniqueNamepspace,p=n.helpers.extend;l={removeProperty:function(a){this.hasOwnProperty(a)&&!this[a].events.length&&delete this[a]},removeAllProperties:function(){for(var a in this)this.hasOwnProperty(a)&&this.removeProperty(a)}},m={addEvent:function(a,b){var c=this;a.split(" ").forEach(function(a){c.events.push({event:a,callback:b})})},removeEvent:function(a){this.events=this.events.filter(function(b){return a.event&&a.callback?b.event!==a.event&&b.callback!==a.callback:a.event?b.event!==a.event:a.callback?b.callback!==a.callback:void 0})}},k={handle:function(a,b,c){n.$(this._eventedObj).on(a,c?n.$.proxy(b,c):b)},handleOnce:function(a,b,c){n.$(this._eventedObj).one(a,c?n.$.proxy(b,c):b)},off:function(a,b){a&&b?n.$(this._eventedObj).off(a,b):a?n.$(this._eventedObj).off(a):n.$(this._eventedObj).off()},trigger:function(a,b){n.$(this._eventedObj).trigger(a,b)},listenTo:function(b,c,e){var f,h=d(this);a(b)&&(f=Array.isArray(c)?c.map(function(a){return a+"."+h}):c+"."+h,n.$(b._eventedObj).on(f,n.$.proxy(e,this)),g(this,b,c,e))},listenToOnce:function(b,c,e){a(b)&&(n.$(b._eventedObj).one(c+"."+d(this),n.$.proxy(h(this,b,c,e),this)),g(this,b,c,e))},stopListening:function(a){i(this,a)}},n.eventer={extend:j}}),define("router",["helpers","application"],function(){"use strict";function a(a,f,g){e.initCalled||(e.init(),e.initCalled=!0,console.log("Coccyx.init called"));var h=b(a,f);h?c(h,g):d(a,f)}function b(a,b){var c,d,g,h,i,j=e.controllers.getRoutes(),k=b.substring(1).split("/"),l=[],m=!1;for(c in j)if(j.hasOwnProperty(c)&&(i=c.substring(0,c.indexOf(" ")),d=c.substring(c.indexOf("/")+1).split("/"),a===i&&(k.length===d.length||f(c,"*")))){h=!0;for(var n=0,o=d.length;o>n;n++)if(k[n]!==d[n]){if(!f(d[n],":")){if(f(d[n],"*")){m=!0,h=!1;break}h=!1;break}g=d[n].split(":"),2===g.length?k[n].substr(0,g[0].length)===g[0]&&l.push(k[n].substr(g[0].length)):l.push(k[n])}if(h)return{controllerName:j[c][0],fn:j[c][1],params:l};if(m){for(var p=n,q=k.length,r="";q>p;p++)r+="/"+k[p];return{controllerName:j[c][0],fn:j[c][1],params:[r]}}}}function c(a,b){var c=e.controllers.getController(a.controllerName);c.hasOwnProperty("init")&&!c.hasOwnProperty("initCalled")&&(c.init(),c.initCalled=!0),b?a.fn.call(c,b):a.params.length?a.fn.apply(c,a.params):a.fn.call(c)}function d(a){console.log("router::routeNotFound called with route = "+a)}var e=window.Coccyx=window.Coccyx||{},f=e.helpers.contains;e.router={route:a}}),define("history",["application","router"],function(){"use strict";function a(a){for(var b={},c=0,d=a.length;d>c;c++)b[a[c].name]=a[c].value;return b}function b(){return f}function c(a,b){e.controllers.registerControllers(b),f=!0,history.replaceState({verb:"get"},null,window.location.pathname),a&&e.router.route("get",window.location.pathname)}function d(a){e.history.started()&&(a=a||{},a.state=a.state||null,a.title=a.title||document.title,a.method=a.method||"get",a.url=a.url||window.location.pathname,a.trigger=a.trigger||!1,a.replace=a.replace||!1,window.history[a.replace?"replaceState":"pushState"](a.state,a.title,a.url),a.trigger&&e.router.route(a.method,a.url))}console.log(history.pushState?"history pushState is supported in your browser":"history pushstate is not supported in your browser");var e=window.Coccyx=window.Coccyx||{},f=!1;e.$(document).on("click","a",function(a){if(0===e.$(this).attr("href").indexOf("/")){a.preventDefault();var b=a.currentTarget.pathname;e.router.route("get",b),history.pushState({verb:"get"},null,a.currentTarget.href)}}),e.$(document).on("submit","form",function(b){var c,d=e.$(this),f=d.attr("action"),g=d.attr("method");0===f.indexOf("/")&&(b.preventDefault(),g=g?g:"get",c=a(d.serializeArray()),e.router.route(g,f,c))}),e.$(window).on("popstate",function(a){a.originalEvent.state&&b()&&e.router.route(a.originalEvent.state.verb,window.location.pathname)}),e.history={start:c,started:b,navigate:d}}),define("models",["helpers","ajax","eventer","application"],function(){"use strict";function a(a,b,c){a.trigger(n,{propertyPath:b,value:c,model:a})}function b(a,c){if(!Array.isArray(a)&&"object"==typeof a){var d=c.split(".");return 1===d.length?a[c]:b(a[d[0]],d.slice(1).join("."))}}function c(a,b,d){var e=b.split(".");1===e.length?a[b]="object"==typeof d?k(d):d:(a.hasOwnProperty(e[0])||(a[e[0]]={}),c(a[e[0]],e.slice(1).join("."),d))}function d(a,b){var c=b.split(".");1===c.length?delete a[b]:(a.hasOwnProperty(c[0])||(a[c[0]]={}),d(a[c[0]],c.slice(1).join(".")))}function e(a){var b=Object.create(h),c=a?l(b,a):b,d=a?Object.create(c):c;return d.isSet=!1,d.isReadOnly=!1,d.isDirty=!1,d.originalData={},d.changedData={},d.data={},i.eventer.extend(d)}function f(a,b){return a=a?a:{},a.url=this.endPoint,"post"!==b&&(a.url+="/"+this.data[this.idPropertyName]),"get"!==b&&(a.data=this.getData()),a}function g(a,b,c){var d,e=i.$.Deferred(),g=this;return d=c(f.call(this,b,a)),d.done(function(b){b="get"===a&&b?g.parse(b):b,b&&g.setData(l(g.getData(),b)),e.resolve(g)}),d.fail(function(a,b,c){e.reject(g,a,b,c)}),e.promise()}var h,i=window.Coccyx=window.Coccyx||{},j=i.ajax,k=i.helpers.deepCopy,l=i.helpers.extend,m=i.helpers.replace,n="MODEL_PROPERTY_CHANGED_EVENT",o=-1,p=i.helpers.isSilent;h={setData:function(a,b){var c={empty:!1,readOnly:!1,dirty:!1,validate:!1};return b&&m(c,b),this.isValid=c.validate&&this.validate?this.validate(a):!0,this.isValid?(this.originalData=c.empty?{}:k(a),this.isReadOnly=c.readOnly,this.isDirty=c.dirty,this.data=k(a),"undefined"==typeof this.idPropertyName&&(this.idPropertyName="id"),this.modelId=this.data.hasOwnProperty(this.idPropertyName)?this.data[this.idPropertyName]:o--,this.changedData={},this.isSet=!0,!0):!1},getData:function(){return k(this.data)},getOriginalData:function(){return k(this.originalData)},getChangedData:function(){return k(this.changedData)},getProperty:function(a){var c=b(this.data,a);return"object"==typeof c?k(c):c},getOriginalDataProperty:function(a){var c=b(this.originalData,a);return"object"==typeof c?k(c):c},getChangedDataProperty:function(a){var c=b(this.changedData,a);return"object"==typeof c?k(c):c},setProperty:function(b,d){return this.isSet&&!this.isReadOnly?(c(this.data,b,d),this.changedData[b]=k(d),this.isDirty=!0,this.data.hasOwnProperty(this.idPropertyName)&&(this.modelId=this.data[this.idPropertyName]),p(arguments)||a(this,b,d)):console.log(this.isSet?"Warning! setProperty called on read only model.":"Warning! setProperty called on model before set was called."),this},deleteProperty:function(b){this.isSet&&!this.isReadOnly?(d(this.data,b),this.changedData[b]=void 0,this.isDirty=!0,this.data.hasOwnProperty(this.idPropertyName)&&(this.modelId=this.data[this.idPropertyName]),p(arguments)||a(this,b,void 0)):console.log(this.isSet?"Warning! deleteProperty called on read only model.":"Warning! deleteProperty called on model before set was called.")},isNew:function(){return"undefined"==typeof this.data[this.idPropertyName]},toJSON:function(){return JSON.stringify(this.data)},ajaxGet:function(a){return g.call(this,"get",a,j.ajaxGet)},ajaxPost:function(a){return g.call(this,"post",a,j.ajaxPost)},ajaxPut:function(a){return g.call(this,"put",a,j.ajaxPut)},ajaxDelete:function(a){return g.call(this,"delete",a,j.ajaxDelete)},parse:function(a){return a}},i.models={extend:e,propertyChangedEvent:n}}),define("collections",["helpers","ajax","eventer","application","models"],function(){"use strict";function a(a){var b=Object.create(o),c=a?q(b,a):b;c.modelsIdPropertyName=c.model&&"undefined"!=typeof c.model.idPropertyName?c.model.idPropertyName:"undefined"!=typeof c.modelsIdPropertyName?c.modelsIdPropertyName:"id",c.modelsEndPoint=c.model&&"undefined"!=typeof c.model.endPoint?c.model.endPoint:"undefined"!=typeof c.modelsEndPoint?c.modelsEndPoint:"/";var d=Object.create(c);return d.isReadOnly=!1,d.coll=[],d.deletedColl=[],p.eventer.extend(d)}function b(a){return Array.isArray(a)?a.map(function(a){return a.getData()}):void 0}function c(a,b){if(Array.isArray(a)&&Array.isArray(b)){if(a.length!==b.length)return!1;for(var e=0,f=a.length;f>e;e++)if("object"!=typeof a[e]||"object"!=typeof b[e]){if("object"==typeof a[e]||"object"==typeof b[e])return!1;if(Array.isArray(a[e])&&Array.isArray(b[e])){if(!c(a[e],b[e]))return!1}else{if(Array.isArray(a[e])||Array.isArray(b[e]))return!1;if(a[e]!==b[e])return!1}}else if(!d(a[e],b[e]))return!1;return!0}return!1}function d(a,b){var e;if(c(a,b))return!0;for(e in a){if(!a.hasOwnProperty(e)||!b.hasOwnProperty(e))return!1;if("object"!=typeof a[e]||"object"!=typeof b[e]){if("object"==typeof a[e]||"object"==typeof b[e])return!1;if(a[e]!==b[e])return!1}else if(!d(a[e],b[e]))return!1}return!0}function e(a,b){return d(a,b)&&d(b,a)}function f(a,b){for(var c in b){if(!b.hasOwnProperty(c)||!a.hasOwnProperty(c))return!1;if("object"==typeof a[c]&&"object"==typeof b[c]){if(!e(a[c],b[c]))return!1}else{if("object"==typeof a[c]||"object"==typeof b[c])return!1;if(b[c]!==a[c])return!1}}return!0}function g(a){return Array.isArray(a)||"object"!=typeof a?!0:!1}function h(a){for(var b=["isSet","isReadOnly","isDirty","originalData","changedData","data"],c=0,d=b.length;d>c;c++)if(!a.hasOwnProperty(b[c]))return!1;return!0}function i(a,b){var c=p.models.extend(a.model?a.model:{idPropertyName:a.modelsIdPropertyName,endPoint:a.modelsEndPoint});return c.setData(b),c}function j(a,b){if(Array.isArray(a)||a.hasOwnProperty("length"))for(var c=0,d=a.length;d>c;c++)j(a[c],b);else b(a)}function k(a,b){return b.handle(p.models.propertyChangedEvent,a.modelPropertyChangedHandler,a),b}function l(a,b){var c=[];return Array.isArray(b)?b.forEach(function(b){a.coll.push(k(a,h(b)?b:i(a,b))),c.push(a.at(a.coll.length-1))}):(a.coll.push(k(a,h(b)?b:i(a,b))),c.push(a.at(a.coll.length-1))),c}function m(a,b){var c=[];return j(b,function(b){var d=h(b)?b:i(a,b);c.push(k(a,d))}),c}function n(a){var b=this;return a&&(Array.isArray(a)?a.forEach(function(a){a.off(p.models.propertyChangedEvent,b.modelPropertyChangedHandler)}):a.off(p.models.propertyChangedEvent,this.modelPropertyChangedHandler)),a}var o,p=window.Coccyx=window.Coccyx||{},q=p.helpers.extend,r="COLLECTION_MODEL_ADDED_EVENT",s="COLLECTION_MODEL_REMOVED_EVENT",t="COLLECTION_SORTED_EVENT",u=p.helpers.isSilent;o={modelPropertyChangedHandler:function(a,b){this.trigger(a,b)},setModels:function(a,b){return this.coll=[],l(this,a),this.isReadOnly=b&&b.readOnly,this},pop:function(){var a=n.call(this,this.coll.pop());return this.deletedColl.push(a),u(arguments)||this.trigger(p.collections.removeEvent,a),a},push:function(a){var b=l(this,a);return u(arguments)||this.trigger(p.collections.addEvent,b),this.coll.length},reverse:function(){this.coll.reverse()},shift:function(){var a=n.call(this,this.coll.shift());return this.deletedColl.push(a),u(arguments)||this.trigger(p.collections.removeEvent,a),a},sort:function(a){this.coll.sort(function(b,c){return a(b,c)}),u(arguments)||this.trigger(p.collections.sortEvent)},splice:function(a,b,c){var d=[a,b],e=m(this,c);d=d.concat(e);var f=n.call(this,[].splice.apply(this.coll,d));return f.length&&this.deletedColl.push.apply(this.deletedColl,f),!u(arguments)&&e&&e.length&&this.trigger(p.collections.addEvent,e),u(arguments)||0===b||this.trigger(p.collections.removeEvent,f),f},unshift:function(a){var b=m(this,a),c=[].unshift.apply(this.coll,b);return u(arguments)||this.trigger(p.collections.addEvent,b),c},getData:function(){return this.map(function(a){return a.getData()})},at:function(a){return this.coll[a]},findById:function(a){for(var b=0,c=this.coll.length;c>b;b++)if(this.at(b).modelId===a)return this.at(b)},slice:function(){var a=this;return[].slice.apply(this.coll,arguments).map(function(b){return i(a,b.getData())})},forEach:function(){[].forEach.apply(this.coll,[].slice.call(arguments,0))},every:function(){return[].every.apply(this.coll,[].slice.call(arguments,0))},some:function(){return[].some.apply(this.coll,[].slice.call(arguments,0))},filter:function(){return[].filter.apply(this.coll,[].slice.call(arguments,0))},map:function(){return[].map.apply(this.coll,[].slice.call(arguments,0))},fetch:function(a){var b,c={url:this.modelsEndPoint},d=p.$.Deferred(),e=this;return a&&(c.dataType=a),b=p.ajax.ajaxGet(c),b.done(function(a){a=a?e.parse(a):a,a&&e.setModels(a),d.resolve(e)}),b.fail(function(a,b,c){d.reject(e,a,b,c)}),d.promise()},setReadOnly:function(a){this.coll.forEach(function(b){b.isReadOnly=a}),this.isReadOnly=a},remove:function(a){var b,c=[];if(0!==this.coll.length&&!g(a))return b=this.coll.filter(function(b){return f(b.data,a)?(c.push(b),!1):!0}),c.length&&(this.deletedColl.push.apply(this.deletedColl,n.call(this,c)),this.coll=b,u(arguments)||this.trigger(p.collections.removeEvent,c)),c},has:function(a){return g(a)?!1:this.coll.some(function(b){return f(b.data,a)})},find:function(a){return g(a)?null:this.coll.filter(function(b){return f(b.data,a)})},toJSON:function(){return this.coll.map(function(a){return JSON.stringify(a.getData())})},toRaw:b,getLength:function(){return this.coll.length},parse:function(a){return a}},p.collections={extend:a,toRaw:b,addEvent:r,removeEvent:s,sortEvent:t}}),define("views",["helpers","application"],function(){"use strict";function a(a){var b,c;for(b in a.events)a.events.hasOwnProperty(b)&&(c=b.split(" "),this.$domTarget.on(c[0]+this.namespace,c[1],a.events[b].bind(a.context||this)))}function b(){this.$domTarget&&this.$domTarget instanceof e.$?this.domTarget=this.$domTarget[0]:this.domTarget?(this.domTarget=document.createElement("string"==typeof this.domTarget?this.domTarget:this.domTarget()),this.$domTarget=e.$(this.domTarget)):this.domTargetAttrs?(this.$domTarget=e.$(document.createElement(this.tagName?this.tagName:"div")).attr(this.domTargetAttrs),this.domTarget=this.$domTarget[0]):(this.domTarget=document.createElement("div"),this.$domTarget=e.$(this.domTarget))}function c(c,f){var h=e.helpers.extend(Object.create(d),c),i=Object.create(h);return b.call(i),f&&(i.namespace=".view_"+g(),Array.isArray(f)&&f.forEach(function(b){a.call(i,"function"==typeof b?b():b)}),a.call(i,"function"==typeof f?f():f)),i}var d,e=window.Coccyx=window.Coccyx||{},f="DOM_EVENT",g=e.helpers.uniqueNamespace;d={remove:function(){this.$domTarget.off(this.namespace),this.$domTarget.empty()},$:e.$},e.views={extend:c,domEventTopic:f}}),define("coccyx",["helpers","eventer","ajax","application","router","history","models","collections","views"],function(){"use strict";return window.Coccyx});